# 統一選擇題格式 - 實作指南

## 變更說明

### 為什麼改用全選擇題？

✅ **優勢：**
1. **互動統一** - 所有題目都是點擊選項，操作一致
2. **實作簡單** - 不需要處理多種輸入類型
3. **判斷明確** - 選項對錯一目了然，無需容錯邏輯
4. **設計靈活** - 可以用選擇題涵蓋各種題型

### 改動內容

**後端（Groq Prompt）：**
- ✅ 要求所有題目都提供 A/B/C/D 四個選項
- ✅ 計算題也設計成選擇題（提供不同數值選項）
- ✅ 應用題也設計成選擇題
- ✅ 概念題設計成選擇題
- ✅ 選項包含常見錯誤答案（增加干擾性）

**前端（InteractiveQuestions.jsx）：**
- ✅ 移除輸入框相關代碼
- ✅ 移除多題型判斷邏輯
- ✅ 簡化答案比對（只比對選項字母）
- ✅ 保留完整的選擇題互動功能

## 題型範例

### 1. 計算題（選擇題格式）

```markdown
## 第1題（計算題）
一輛汽車行駛了 $150\text{ km}$，用了 $3\text{ h}$，平均速率是多少？

A) $40\text{ km/h}$
B) $45\text{ km/h}$
C) $50\text{ km/h}$
D) $55\text{ km/h}$

**正確答案：** C

**詳細解析：**
使用公式 $v = \frac{d}{t}$：
$$v = \frac{150\text{ km}}{3\text{ h}} = 50\text{ km/h}$$

**常見錯誤：**
- 選項 A (40)：可能是計算錯誤
- 選項 B (45)：可能是除法錯誤
- 選項 D (55)：可能是約略計算偏差

---
```

### 2. 應用題（選擇題格式）

```markdown
## 第2題（應用題）
小明從家走到學校，距離是 $800\text{ m}$，用了 10 分鐘，他的速率是多少 $\text{m/min}$？

A) $60\text{ m/min}$
B) $70\text{ m/min}$
C) $80\text{ m/min}$
D) $90\text{ m/min}$

**正確答案：** C

**詳細解析：**
使用速率公式：
$$v = \frac{d}{t} = \frac{800\text{ m}}{10\text{ min}} = 80\text{ m/min}$$

---
```

### 3. 概念題（選擇題格式）

```markdown
## 第3題（概念題）
下列哪一個敘述正確描述了「速率」的定義？

A) 速率是向量，包含大小和方向
B) 速率是純量，只描述物體運動的快慢
C) 速率和速度是完全相同的概念
D) 速率的單位必須是 m/s

**正確答案：** B

**詳細解析：**
- **速率（speed）** 是純量，只有大小，描述物體運動的快慢
- **速度（velocity）** 是向量，有大小和方向
- 速率可以使用多種單位，如 m/s、km/h 等

**為何其他選項錯誤：**
- 選項 A：速率是純量，不是向量
- 選項 C：速率和速度是不同的概念
- 選項 D：速率單位可以是 m/s、km/h、cm/s 等多種

---
```

### 4. 單位換算題（選擇題格式）

```markdown
## 第4題（單位換算）
將速率 $5\text{ m/s}$ 換算成 $\text{km/h}$，結果是多少？

A) $12\text{ km/h}$
B) $15\text{ km/h}$
C) $18\text{ km/h}$
D) $20\text{ km/h}$

**正確答案：** C

**詳細解析：**
單位換算步驟：
$$5\text{ m/s} = 5 \times \frac{3600\text{ s}}{1\text{ h}} \times \frac{1\text{ km}}{1000\text{ m}} = 18\text{ km/h}$$

或使用簡化公式：
$$\text{m/s} \times 3.6 = \text{km/h}$$
$$5 \times 3.6 = 18\text{ km/h}$$

**常見錯誤：**
- 選項 A (12)：可能是乘以 2.4 而非 3.6
- 選項 B (15)：可能是乘以 3 而非 3.6
- 選項 D (20)：可能是乘以 4 而非 3.6

---
```

## Prompt 設計要點

### 關鍵要求

```python
**【重要】格式要求（必須嚴格遵守）：**
1. 每題必須以 ## 第X題（題型） 開始
2. 題型可以是：（選擇題）、（計算題）、（應用題）、（概念題）等
3. **所有題目都必須提供 A) B) C) D) 四個選項**
4. 選項必須用 `A) 內容` 格式，括號後加空格
5. 每個選項獨立一行
6. 正確答案格式：**正確答案：** A（只寫選項字母）
7. 詳細解析格式：**詳細解析：** 然後換行寫內容
8. 每題結束必須用 --- 分隔
```

### 選項設計原則

```python
要求：
1. 設計 3-5 題針對本章節的練習題
2. **所有題目都必須是選擇題格式，提供 A/B/C/D 四個選項**
3. 題型可以多樣化（計算題、應用題、概念題等），但都要有選項
4. 選項設計要有干擾性，包含常見錯誤答案
5. 四個選項中要包含：
   - 1 個正確答案
   - 3 個有干擾性的錯誤答案
6. 錯誤選項應該是學生可能犯的常見錯誤：
   - 計算錯誤（如乘除錯誤）
   - 單位換算錯誤
   - 概念混淆
   - 約略計算偏差
```

## 前端組件簡化

### 移除的功能

❌ **不再需要：**
- 輸入框（`<input>`）
- 多行文字區域（`<textarea>`）
- 輸入答案處理（`handleInputAnswer`）
- 數值容錯比對
- 文字標準化比對
- 多題型判斷邏輯

### 保留的功能

✅ **保留：**
- 選項點擊選擇
- 選項狀態顏色（未選/已選/正確/錯誤）
- 提交答案按鈕
- 對錯結果顯示
- 詳細解析顯示
- 數學公式渲染（題目、選項、解析）

### 答案判斷邏輯

```javascript
const isCorrect = (questionIndex) => {
  const question = questions[questionIndex];
  const userAnswer = userAnswers[questionIndex];
  
  if (!userAnswer) return false;
  
  // 比較選項字母（支援 "A" 或 "A)" 格式）
  const normalizedUserAnswer = userAnswer.charAt(0).toUpperCase();
  const normalizedCorrectAnswer = question.answer.charAt(0).toUpperCase();
  
  return normalizedUserAnswer === normalizedCorrectAnswer;
};
```

**簡化說明：**
- 只需比對第一個字母（A/B/C/D）
- 自動處理大小寫
- 支援 "A" 和 "A)" 兩種格式

## 使用流程

### 完整答題流程

```
1. 📖 閱讀題目和題型標籤
   ↓
2. 📋 查看 4 個選項（A/B/C/D）
   ↓
3. 🤔 思考並選擇答案
   ↓
4. 🖱️ 點擊選項（選項變藍色）
   ↓
5. 📝 點擊"提交答案"按鈕
   ↓
6. ✓/✗ 查看結果
   - 答對：綠色 ✓
   - 答錯：紅色 ✗
   ↓
7. 💡 查看正確答案（藍色卡片）
   ↓
8. 📚 閱讀詳細解析（灰色卡片）
   - 計算步驟
   - 公式說明
   - 常見錯誤分析
   ↓
9. 🔄 繼續下一題
```

### 視覺反饋

| 狀態 | 顏色 | 圖標 |
|------|------|------|
| 未選擇 | 灰色邊框 + 白色背景 | - |
| 已選擇 | 藍色邊框 + 淺藍背景 | - |
| 正確答案（提交後） | 綠色邊框 + 淺綠背景 | ✓ |
| 錯誤選項（提交後） | 紅色邊框 + 淺紅背景 | ✗ |
| 其他選項（提交後） | 灰色邊框 + 灰色背景 | - |

## 優勢總結

### ✅ 用戶體驗
- **操作一致**：所有題目都是點擊選項
- **即時反饋**：選擇後立即看到藍色高亮
- **結果明確**：對錯用顏色和圖標清楚標示
- **學習效果**：詳細解析包含常見錯誤說明

### ✅ 開發維護
- **代碼簡潔**：移除多餘的輸入處理邏輯
- **邏輯清晰**：只需處理一種題型
- **易於測試**：答案判斷邏輯簡單直接
- **擴展性好**：未來添加新題型時保持格式一致

### ✅ 教學品質
- **題目靈活**：可以用選擇題涵蓋各種知識點
- **干擾有效**：錯誤選項反映常見錯誤
- **解析完整**：可以解釋為何其他選項錯誤
- **評分客觀**：選項對錯明確，無爭議

## 測試建議

### 1. 重啟後端
```bash
# 停止現有後端（Ctrl+C）
cd backend
python main.py
```

### 2. 生成新教材
- 選擇科目（物理、數學等）
- 填寫表單並生成
- 等待章節生成完成

### 3. 測試選擇題功能

#### 基本功能測試
- [ ] 題目和選項正確顯示
- [ ] 數學公式正確渲染
- [ ] 點擊選項可以選擇
- [ ] 選中的選項顯示藍色
- [ ] 可以改選（提交前）
- [ ] 提交按鈕出現

#### 答題測試
- [ ] 點擊"提交答案"
- [ ] 正確答案顯示綠色 + ✓
- [ ] 錯誤答案顯示紅色 + ✗
- [ ] 結果提示正確（✓ 答對了 / ✗ 答錯了）
- [ ] 正確答案卡片顯示
- [ ] 詳細解析顯示並正確渲染

#### 題型多樣性測試
- [ ] 計算題（有數值選項）
- [ ] 應用題（情境題）
- [ ] 概念題（理論題）
- [ ] 單位換算題
- [ ] 所有題型都有 4 個選項

## 範例題目集

### 物理 - 速率單元

```markdown
## 第1題（概念題）
下列哪一項正確描述了速率的性質？

A) 速率是向量量，有大小和方向
B) 速率是純量，只有大小沒有方向
C) 速率一定等於速度的大小
D) 速率的 SI 單位必須是 km/h

**正確答案：** B

---

## 第2題（計算題）
小華騎腳踏車行駛 $15\text{ km}$，花了 30 分鐘，他的平均速率是多少？

A) $0.5\text{ km/h}$
B) $15\text{ km/h}$
C) $30\text{ km/h}$
D) $45\text{ km/h}$

**正確答案：** C

---

## 第3題（單位換算）
將 $72\text{ km/h}$ 換算成 $\text{m/s}$，結果是？

A) $10\text{ m/s}$
B) $20\text{ m/s}$
C) $30\text{ m/s}$
D) $40\text{ m/s}$

**正確答案：** B

---
```

---

**統一選擇題格式讓系統更簡潔、更穩定！** 🎯✨

**前端會自動刷新，記得重啟後端套用新的 prompt！**

